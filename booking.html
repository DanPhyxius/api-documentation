<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title></title>

        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/font-awesome.min.css">
        <link rel="stylesheet" href="/css/highlight.dark.css">
        <link rel="stylesheet" href="/css/main.css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="/">
                The title
                <small class="hidden-xs hidden-sm">
                    This is the default subtitle!
                </small>
            </a>

            
        </header>

        <main class="container">
            <div class="row">

                
                <section id="content" class="col-sm-12">
                    <h2 id="booking">Booking</h2>
<p>The booking process allows you to book an event. Once you have found the <em>Event</em> you want to book, using the search or browsing the catalogues, for a successful booking you have to follow this flow.</p>
<p>We assume you already retrieved the all the infomation for the <em>Event</em> using the call:</p>
<pre><code>GET /api/v3/events/{id}</code></pre>
<h3 id="booking-flow">Booking flow</h3>
<p><img src="http://musement.s3.amazonaws.com/documentation_images/booking.png" alt="Booking" /></p>
<ol>
<li>Search for the available dates for the <em>Event</em>. | <a href="https://thack.musement.com/documentation#get--api-v3-events-{id}-dates.{_format}">Test it</a></li>
</ol>
<p>Returns a list of all days with availabitiy for a specific <em>Event</em> over a period of time.</p>
<h4><em>Request</em></h4>
<pre><code>GET /api/v3/events/{id}/dates</code></pre>
<p>To specify the period you can use the parameters <code>from_date</code> and <code>end_date</code>. If none of this parameters are specified <code>from_date</code> is set to the current day. If <code>end_date</code> is not specified then <code>end_date</code> is set same as <code>from_date</code>.</p>
<p><strong>Examples:</strong></p>
<p><strong><em> No parameters </em></strong> </p>
<p><code>from_date</code> and <code>end_date</code> are set as the current day. This call return the current date if there is availabitiy an empty array otherwise.</p>
<pre><code>GET /api/v3/events/497/dates</code></pre>
<p><strong><em> With parameters </em></strong> </p>
<p>Search for available dates for dicember 2016</p>
<pre><code>GET /api/v3/events/497/dates?from_date=2016-12-01&amp;end_date=2016-12-31</code></pre>
<p><strong>Example Response:</strong></p>
<p>The response is a collection of date</p>
<pre><code>[
  {
    "date": "2016-01-14"
  },
  {
    "date": "2016-01-25"
  }
]</code></pre>
<h3 id="3-find-tickets-available-for-selected-day">3 Find tickets available for selected day</h3>
<p>Once you found the date the next step is search for all available tickets for that day. Please note that for the same event different days can have different type of tickets.</p>
<h4><em>Request</em></h4>
<p><code>GET /events/{id}/dates/{YYYY-MM-DD}</code> | [Test it]</p>
<p>The response is a collection of items containing : </p>
<ul>
<li><code>datetime</code> - The date and time. For a single day an event can have more starting time.</li>
<li><code>seats</code> - A collection of all available <code>seats</code> (AKA <code>tickets</code>). Here the seat structure</li>
<li><code>open_ticket</code> - If true the event is an <code>Open ticket</code></li>
<li><code>availability</code> - Number of place avaialble</li>
<li><code>languages</code> - The event can be available in different language. Different time can have different languages</li>
</ul>
<p><code>seat</code> structure:</p>
<ul>
<li><code>id</code> - Unique seat identifier</li>
<li><code>price_tag</code> - Give info about the person the ticket is for. Ticket type (<code>name</code>) and type of person (<code>group</code>) the <code>seat</code> is for. Please note that for the same date and time the combination of <code>name</code> and <code>group</code>  is unique but you can have more seat with the same <code>group</code> or <code>name</code></li>
<li><code>max_buy</code> and <code>min_buy</code> - Maximum and minimum number of ticket buyiable in a single transaction</li>
<li><code>raw_price</code> and <code>retail_price</code> - Internal and public price</li>
</ul>
<h4><em>Example</em></h4>
<p><code>GET /api/v3/events/497/dates/2016-01-15</code></p>
<p>Response</p>
<pre><code>[
  {
    "datetime": "2016-01-14T13:45:00+0000",
    "seats": [
      {
        "id": 8216618,
        "price_tag": {
          "name": "Full price",
          "group": "Tour",
          "locale": "en"
        },
        "max_buy": 15,
        "min_buy": 1,
        "raw_price": {
          "currency": "EUR",
          "value": 40,
          "formatted_value": "€ 40.00"
        },
        "retail_price": {
          "currency": "EUR",
          "value": 40,
          "formatted_value": "€ 40.00"
        }
      }
    ],
    "open_ticket": false,
    "availability": 9,
    "languages": [
      "en"
    ]
  }
]</code></pre>
<h3 id="35-create-the-order">3.5 Create the order</h3>
<p>When the cart is completed (<strong>with customer info filled in</strong>) and you want to finalize it (proceed with payments and check the availability one last time) </p>
<p><code>POST /api/v3/order</code></p>
<h3 id="36-finalize-the-order">3.6 Finalize the order</h3>
<p>If the order amount is equal to 0 or you use your payment gateway, use the flow without payment (ask for activation). Otherwise follow the Payment flow in 4.4.2.</p>
<h4 id="361-without-payment-flow">3.6.1 Without Payment Flow</h4>
<p>Request <code>POST /api/v3/payments/no-payment</code></p>
<h4 id="362-with-payment-flow">3.6.2 With Payment Flow</h4>
<h5 id="braintree-payments">Braintree Payments</h5>
<p>You have to integrate Braintree SDK</p>
<p>Note: in QA endpoint use credit card numbers contained in this link <a href="https://developers.braintreepayments.com/reference/general/testing/ruby#credit-card-numbers">https://developers.braintreepayments.com/reference/general/testing/ruby#credit-card-numbers</a> </p>
<h6 id="step-1">Step 1</h6>
<p>GET the token</p>
<p>Request <code>POST /api/v3/payments/braintree/token</code>
Response <code>{ "nonce": "eyJ2ZXJzaW9uIjoyLCJhdXRob3JpemF0aW9uRmluZ2VycHJpbnQiOiI3MDVjY2JlZThmZDRkNzI3MWQ2NTJjZDVjOTZjZDAyOTA5YWEzZDA4ZTJhN2ExNDVlNzc3MTI3MWYxMTUzMDIxfGNyZWF0ZWRfYXQ9MjAxNi0wMi0wM1QxMzowNzowOS43NjQ5NDQ2NjIrMDAwMFx1MDAyNm1lcmNoYW50X2lkPXE5MjdzdGt5cjRtZHc1MnhcdTAwMjZwdWJsaWNfa2V5PWNzMjJkMjJzbjc2ano4YzYiLCJjb25maWdVcmwiOiJodHRwczovL2FwaS5icmFpbnRyZWVnYXRld2F5LmNvbTo0NDMvbWVyY2hhbnRzL3E5MjdzdGt5cjRtZHc1MngvY2xpZW50X2FwaS92MS9jb25maWd1cmF0aW9uIiwiY2hhbGxlbmdlcyI6WyJjdnYiXSwiZW52aXJvbm1lbnQiOiJwcm9kdWN0aW9uIiwiY2xpZW50QXBpVXJsIjoiaHR0cHM6Ly9hcGkuYnJhaW50cmVlZ2F0ZXdheS5jb206NDQzL21lcmNoYW50cy9xOTI3c3RreXI0bWR3NTJ4L2NsaWVudF9hcGkiLCJhc3NldHNVcmwiOiJodHRwczovL2Fzc2V0cy5icmFpbnRyZWVnYXRld2F5LmNvbSIsImF1dGhVcmwiOiJodHRwczovL2F1dGgudmVubW8uY29tIiwiYW5hbHl0aWNzIjp7InVybCI6Imh0dHBzOi8vY2xpZW50LWFuYWx5dGljcy5icmFpbnRyZWVnYXRld2F5LmNvbSJ9LCJ0aHJlZURTZWN1cmVFbmFibGVkIjpmYWxzZSwicGF5cGFsRW5hYmxlZCI6dHJ1ZSwicGF5cGFsIjp7ImRpc3BsYXlOYW1lIjoiTXVzZW1lbnQiLCJjbGllbnRJZCI6IkFkcTdxSTJrS2NNTEFIQjRGRDRac1JxNC13VGp0eUxnckhRdllSTGMtQ1k0MGFmZlh2dUYwUHpLRUJSSVZfRktJeTVaNmJvREZpY1A2ZmIzIiwicHJpdmFjeVVybCI6Imh0dHBzOi8vd3d3Lm11c2VtZW50LmNvbS9lbi9wL3ByaXZhY3kiLCJ1c2VyQWdyZWVtZW50VXJsIjoiaHR0cHM6Ly93d3cubXVzZW1lbnQuY29tL2VuL3AvdGVybXMtY29uZGl0aW9ucyIsImJhc2VVcmwiOiJodHRwczovL2Fzc2V0cy5icmFpbnRyZWVnYXRld2F5LmNvbSIsImFzc2V0c1VybCI6Imh0dHBzOi8vY2hlY2tvdXQucGF5cGFsLmNvbSIsImRpcmVjdEJhc2VVcmwiOm51bGwsImFsbG93SHR0cCI6ZmFsc2UsImVudmlyb25tZW50Tm9OZXR3b3JrIjpmYWxzZSwiZW52aXJvbm1lbnQiOiJsaXZlIiwidW52ZXR0ZWRNZXJjaGFudCI6ZmFsc2UsImJyYWludHJlZUNsaWVudElkIjoiQVJLcllSRGgzQUdYRHpXN3NPXzNiU2txLVUxQzdIR191V05DLXo1N0xqWVNETlVPU2FPdElhOXE2VnBXIiwiYmlsbGluZ0FncmVlbWVudHNFbmFibGVkIjpmYWxzZSwibWVyY2hhbnRBY2NvdW50SWQiOiJtdXNlbWVudEVVUiIsImN1cnJlbmN5SXNvQ29kZSI6IkVVUiJ9LCJjb2luYmFzZUVuYWJsZWQiOmZhbHNlLCJtZXJjaGFudElkIjoicTkyN3N0a3lyNG1kdzUyeCIsInZlbm1vIjoib2ZmIiwiYXBwbGVQYXkiOnsic3RhdHVzIjoicHJvZHVjdGlvbiIsImNvdW50cnlDb2RlIjoiVVMiLCJjdXJyZW5jeUNvZGUiOiJFVVIiLCJtZXJjaGFudElkZW50aWZpZXIiOiJtZXJjaGFudC5jb20ubXVzZW1lbnQubXVzZW1lbnRwcm9kIiwic3VwcG9ydGVkTmV0d29ya3MiOlsidmlzYSIsIm1hc3RlcmNhcmQiXX18" }</code></p>
<h6 id="step-2">Step 2</h6>
<p>Using Braintree SDK, ask the user for payment information (credit card, paypal etc). For more details please visit: <a href="https://developers.braintreepayments.com/">https://developers.braintreepayments.com/</a></p>
<h6 id="step-3">Step 3</h6>
<p>After the user fills out the braintree payment form, ask us to process the payment and close the order </p>
<p>Request <code>POST /api/v3/payments/braintree/payment</code></p>
<p>Request Body </p>
<pre><code>{
  "nonce" : "nonce_text",
  "orderId" : 123456
}</code></pre>
<h3 id="37-retrieve-the-voucher">3.7 Retrieve the voucher</h3>
<p>If you used the login 2.1.2 you can retrieve the voucher with the Request</p>
<p><code>GET /customer/me/orders</code></p>
<p>Otherwise we will send it to your email address.</p>
                </section>

            </div>
        </main>

        <footer>
            <div class="container">
                <p class="text-muted">
                    website generated with <a href="http://couscous.io" title="Markdown website generator">Couscous</a>
                </p>
            </div>
        </footer>

        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
        <script src="//yastatic.net/highlightjs/8.2/highlight.min.js"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
